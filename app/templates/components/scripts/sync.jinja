<script>
        var interval = 2000;  // 1000 = 1 second
        function syncState() {
                $.ajax({
                        type: 'GET',
                        url: '{{ url_for("sync_state")}}',
                        success: function (data) {
                                if (data.connection.state === 'active') {
                                        $('#connection-avatar').html(`<span class="avatar avatar-xl"
                                        style="background-image: url({{ avatars.gravatar('${data.connection.alias}') }})"></span>`);
                                        $('#connection-label').html(data.connection.their_label);
                                        $('#btn-message').removeClass("disabled");
                                        $('#btn-issuance').removeClass("disabled");
                                        $('#btn-presentation').removeClass("disabled");
                                } else {}
                                if (data.cred_ex.state === 'done') {
                                        $('#issuance-state').html(`<span class="badge bg-green"></span> done`);
                                        $('#btn-revocation').removeClass("disabled");
                                } else if (data.cred_ex.state === 'abandonned') {
                                        $('#issuance-state').html(`<span class="badge bg-danger"></span> abandonned`);
                                } else {
                                        $('#issuance-state').html(`<span class="badge bg-warning"></span> pending`);
                                }
                                if (data.pres_ex.state === 'done') {
                                } else {}
                                // $('#registry-state').html(``);
                                console.log(data);
                        },
                        complete: function (data) {
                                // Schedule the next
                                setTimeout(syncState, interval);
                        }
                });
        }
        setTimeout(syncState, interval);
</script>